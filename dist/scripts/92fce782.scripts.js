"use strict";function imageTfr(a){for(var b in a)a[a[b].size]=a[b]["#text"]}angular.module("guityApp",["ngCookies","ngResource","ngSanitize","ngRoute","google-maps","wu.masonry"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/search.html",controller:"searchCtrl"}).when("/artist/:mbid",{templateUrl:"views/artist.html",controller:"artistCtrl"}).when("/artist/similar/:mbid",{templateUrl:"views/similar.html",controller:"similarCtrl"}).when("/artist/events/:mbid",{templateUrl:"views/events.html",controller:"eventsCtrl"}).when("/artist/albums/:mbid",{templateUrl:"views/albums.html",controller:"albumsCtrl"}).when("/artist/albums/:name/:mbid",{templateUrl:"views/album.html",controller:"albumCtrl"}).otherwise({redirectTo:"/"})}]).controller("appCtrl",["$scope",function(a){a.$on("load",function(){a.loading=!0}),a.$on("unload",function(){a.loading=!1})}]);var key="2776b29967e1bfd49cfc90686cd48b6c",lastfm="http://ws.audioscrobbler.com/2.0/?api_key="+key+"&format=json";angular.module("guityApp").factory("artistSearch",["$resource",function(a){return a(lastfm+"&method=artist.search&artist=:artist",{},{query:{method:"GET",isArray:!1}})}]).controller("searchCtrl",["$scope","artistSearch",function(a,b){a.$watch("searchField",function(c){if(c)var d=b.query({artist:c},function(){var b=d.results.artistmatches.artist;for(var c in b)imageTfr(b[c].image);a.artists=d.results.artistmatches.artist});else a.artists=[]})}]).directive("fadey",function(){return{restrict:"A",link:function(a,b,c){jQuery(b).css({opacity:0}).animate({opacity:1},parseInt(c.fadey))}}}),function(){angular.module("guityApp").service("getData",["$http","$routeParams",function(a,b){return{async:function(){return a.get(lastfm+"&method=artist.getInfo&mbid="+b.mbid)}}}]).controller("artistCtrl",["$scope","$routeParams","$http","getData",function(a,b,c,d){a.$emit("load"),d.async().then(function(b){var c=b.data.artist.image;for(var d in c)c[c[d].size]=c[d]["#text"];a.artist=b.data.artist,console.log(a.artist);var e=new countUp("listeners",0,b.data.artist.stats.listeners);e.start();var f=new countUp("scrobblers",0,b.data.artist.stats.playcount);f.start(),a.$emit("unload")})}]).controller("spotifyCtrl",["$scope","$http","$sce","getData",function(a,b,c,d){d.async().then(function(d){a.sname=d.data.artist.name,b.get("http://ws.spotify.com/search/1/track.json?q="+a.sname).success(function(b){a.tracks=b.tracks,a.trustSrc=function(a){return c.trustAsResourceUrl(a)},a.embed="https://embed.spotify.com/?uri="}),a.limit=1})}])}(),function(){angular.module("guityApp").controller("similarCtrl",["$scope","$routeParams","$http","getData",function(a,b,c,d){a.$emit("load"),d.async().then(function(b){var d=b.data.artist.image;for(var e in d)d[d[e].size]=d[e]["#text"];a.artist=b.data.artist,a.similarTo=b.data.artist.name,c.get(lastfm+"&method=artist.getsimilar&artist="+a.similarTo.replace("&","%26")).success(function(b){a.similars=b.similarartists.artist,jQuery.each(a.similars,function(a,b){var c=b.image;for(var d in c)c[c[d].size]=c[d]["#text"]}),a.$emit("unload")}),a.limit=20})}])}(),angular.module("guityApp").controller("eventsCtrl",["$scope","$routeParams","$http","getData",function(a,b,c,d){a.$emit("load"),d.async().then(function(b){var d=b.data.artist.image;for(var e in d)d[d[e].size]=d[e]["#text"];a.artist=b.data.artist,a.name=b.data.artist.name,c.get(lastfm+"&method=artist.getevents&artist="+a.name).success(function(b){a.events=b.events.event,a.nextEvent=b.events.event[0],console.log(a.nextEvent),a.lat=a.nextEvent.venue.location["geo:point"]["geo:lat"],a.long=a.nextEvent.venue.location["geo:point"]["geo:long"],a.map={center:{latitude:a.lat,longitude:a.long},marker:{latitude:a.lat,longitude:a.long},zoom:8},a.$emit("unload")}),a.limit=10})}]),angular.module("guityApp").controller("albumsCtrl",["$scope","$routeParams","$http","getData",function(a,b,c,d){a.$emit("load"),d.async().then(function(b){var d=b.data.artist.image;for(var e in d)d[d[e].size]=d[e]["#text"];a.artist=b.data.artist,console.log(a.artist),a.name=b.data.artist.name,c.get(lastfm+"&method=artist.gettopalbums&artist="+a.name.replace("&","%26")).success(function(b){a.albums=b.topalbums.album,jQuery.each(a.albums,function(a,b){var c=b.image;for(var d in c)c[c[d].size]=c[d]["#text"]})}),a.$emit("unload")})}]),angular.module("guityApp").controller("albumCtrl",["$scope","$routeParams","$http","getData",function(a,b,c,d){a.$emit("load"),d.async().then(function(d){var e=d.data.artist.image;for(var f in e)e[e[f].size]=e[f]["#text"];a.artist=d.data.artist,console.log(a.artist),a.name=d.data.artist.name,c.get(lastfm+"&method=album.getinfo&artist="+a.name.replace("&","%26")+"&album="+b.name).success(function(b){a.album=b.album,a.tracks=b.album.tracks.track;var c=a.album.image;for(var d in c)c[c[d].size]=c[d]["#text"];a.$emit("unload")})})}]);